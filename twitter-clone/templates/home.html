{% extends 'main_template.html' %}
{% load static %}
{% block content %}
            <div class = 'container d-flex flex-column'>
                <div class = 'border border-secondary border-top-0 p-3 font-weight-bold'>Main Page</div>
                <div class = 'border border-secondary p-3 d-flex flex-column'>
                    <form action='home' method='post'>
                        {% csrf_token %}
                        <div class = 'd-flex flex-row'>
                            <div><img src= "media/{{ user.profile.profilePic }}" class='profilePic mr-2' onerror="this.onerror=null; this.src='{% static 'defaultPic.jpg' %}'" alt=""></div>
                            <div class='w-100'>
                                <textarea class='w-100 h-100 m-1 input' placeholder="Tweet" name='tweet'></textarea>
                            </div>
                        </div>
                        <div class = 'd-flex flex-row-reverse'>
                            <button class = 'btn btn-info badge-pill w-25 mt-3 button'>Tweet</button>
                        </div>
                    </form>
                </div>
                {% for tweet in tweets %}
                    <div class = 'border border-secondary d-flex flex-column w-100 p-3'>
                        <div class = 'm-1 text-white-50'>{{tweet.author}} &#8226;&#8226;&#8226;  {{tweet.timeStamp}}</div>
                        <div class = 'm-1'>{{tweet.content}}</div>
                        <div class = 'm-1 text-white-50'>
                        <a href='{% url 'like_post' tweet.id %}'>
                        <img src={% if user in tweet.likes.all %}
                            {% static 'heartC.png' %}
                            class = 'mr-2'
                            {% else %}
                            {% static 'heart.png' %}
                            class = 'icon mr-2'
                            {% endif %} 
                        onClick="changeImage(this)"></a>{{tweet.likes.count}} <img src={% static 'comment.png' %} class = 'icon ml-5 mr-2'> Y</div>
                    </div>
                {% endfor %}
            </div>
        <script>
            let input = document.querySelector(".input")
            let button = document.querySelector(".button")

            button.disabled = true

            input.addEventListener("input", stateHandle)

            function stateHandle() {
                textValue = input.value
                if (/\S/.test(textValue)) 
                {
                    button.disabled = false
                } 
                else 
                {
                    button.disabled = true
                }
            }

            function changeImage(thi) {
                if (thi.getAttribute("src") == "{% static 'heart.png' %}")
                {
                    thi.setAttribute("src", "{% static 'heartC.png' %}");
                    thi.classList.remove('icon')
                }
                else
                {
                    thi.setAttribute("src", "{% static 'heart.png' %}");
                    thi.classList.add('icon')
                }  
            }
        </script> 
{% endblock content %}